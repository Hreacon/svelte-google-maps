<script>
  export default {
    oncreate() {
      let { map, position, lat, lng, title, label, icon } = this.get();
      if (lat && lng && !position) position = { lat: Number(lat), lng: Number(lng) };

      const marker = map.ready().then(({ api, instance }) => {
        return new api.Marker({
          position,
          title,
          label,
          icon,
          map: instance
        });
      });
      
      this.set({ marker });
    },

    async ondestroy() {
      const marker = await this.get('marker');
      marker.setMap(null);
    }
  }
</script>
